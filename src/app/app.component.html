	<div class="container">
			<h1>ISD Portal Group Management</h1>
			<div *ngIf="!selectedGroup">
				<div class="form-horizontal" >
					<div class="form-group" tooltip="You can enter one email or multiple emails separated by semi-colon ';'">
						<label class="control-label col-sm-2"><strong>Search People:</strong></label>
						<div class="col-sm-10">
							<input [(ngModel)]="searchTerm" class="form-control" type="text" (keyup)="search();"   placeholder="type to search...">
						</div>
					</div>	
				</div>
				<table style="table-layout:fixed;" class="table table-striped table-hover table-condensed">
					<thead>
						<tr>						
							<th style="width:10%;">Group Name</th>
							<th style="width:30%;">Descriptionn</th>
							<th style="width:5%;">Members</th>
							<th style="width:55%;">Emails</th>
						</tr>
					</thead>
					<tbody>
						<tr [class.taxTableRow]="true" *ngFor="let group of groups;" (click)="onSelect(group)" [class.info]="group===selectedGroup">
							<td style="word-wrap:break-word;">{{group.title}} </td>
							<td style="word-wrap:break-word;">{{group.description}} </td>
							<td style="word-wrap:break-word;">{{group.arrayOfEmails.length}} </td>
							<td style="word-wrap:break-word;">{{group.emails}}</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div *ngIf="selectedGroup">
				<input type="button" style="margin-bottom:10px;" class="btn btn-primary" (click)="selectedGroup=null;"  value="Go Back" />
				<div class="well">
					<h2>Add / Remove People for: {{selectedGroup.title}}</h2>	
					<div style="padding-bottom:5px;">
						<strong>Group description:</strong>
						{{selectedGroup.description}}
					</div>
					<div  style="padding-bottom:5px;" *ngIf="selectedGroup.spGroupName">
						<strong>Associated SharePoint Group:</strong>
						{{selectedGroup.spGroupName}}
					</div>
					<div *ngIf="successMessage" class="alert alert-success">
						<strong>Success!!!</strong> {{successMessage}}
					</div>
					<div>
						<div class="form-group" tooltip="You can enter one email or multiple emails separated by semi-colon ';'">
							<label>Enter email(s) to add to this security / mailing group:</label>
							<input [(ngModel)]="emailsToAdd"  class="form-control" type="text"  (keyup.enter)="add();" placeholder="You can enter one email or multiple emails separated by semi-colon ';'"  tooltip="You can enter one email or multiple emails separated by semi-colon ';'">
							<div *ngIf="errorAdding" class="alert alert-danger" >
								{{errorAdding}}
							</div>
						</div>	
							
							<input type="button" class="btn btn-primary" (click)="add();"  value="Add Email(s)" />
						<div style="margin-top:10px;">
							<input style="margin-bottom:10px;" type="button" class="btn btn-primary" (click)="removeSelected();" value="Remove Selected" [disabled]="(!(emailsToErase&&(emailsToErase.length>0)))|| (selectedGroup.arrayOfEmails.length==emailsToErase.length)" />
							Total count of emails: {{selectedGroup.arrayOfEmails.length}}
							<div style="word-wrap:break-word;" class="alert alert-info" *ngIf="emailsToErase&&emailsToErase.length>0&& emailsToErase.length!=selectedGroup.arrayOfEmails.length">
								<p><strong>You are getting ready to erase {{emailsToErase.length}} emails:</strong></p>
								<span *ngFor="let a of emailsToErase">{{a}},</span>
								<p><strong>Click on 'Remove Selected' to confirm permanent deletion.</strong></p>
							</div>
							<div style="word-wrap:break-word;" class="alert alert-info" *ngIf="emailsToErase&&emailsToErase.length>0&& emailsToErase.length==selectedGroup.arrayOfEmails.length">
								<p><strong>You can't erase all emails, at least one contact email must remain in this group.</strong></p>
							</div>
							<div *ngIf="errorRemoving" class="alert alert-danger">
								{{errorRemoving}}
							</div>
							<div class="list-group" style="max-height:300px;overflow-y:auto">
								<a href="#" [class.taxActive]="emailsToErase.indexOf(emailEntry)>=0" class="list-group-item" (click)="onChange2(emailEntry)"  *ngFor="let emailEntry of selectedGroup.arrayOfEmails" >
									<input style="margin-right:35px;"  type="checkbox" value="{{emailEntry}}" [checked]="emailsToErase.indexOf(emailEntry)>=0" />{{emailEntry}}
								</a>
							</div>
							<div *ngIf="errorRemoving" class="alert alert-danger">
								{{errorRemoving}}
							</div>
							<input style="margin-top:10px;" type="button" class="btn btn-primary" (click)="removeSelected();" value="Remove Selected" [disabled]="(!(emailsToErase&&(emailsToErase.length>0)))|| (selectedGroup.arrayOfEmails.length==emailsToErase.length)" />
							Total count of emails: {{selectedGroup.arrayOfEmails.length}}
						</div>
						
					</div>
					<div  *ngIf="successMessage" class="alert alert-success">
						<strong>Success!!!</strong> {{successMessage}}
					</div>
				</div>
				<input type="button" class="btn btn-primary" (click)="selectedGroup=null;"  value="Go Back" />
			</div>
	</div>	